"use strict";(self.webpackChunkrekalogika_docs=self.webpackChunkrekalogika_docs||[]).push([[3980],{6016:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>l,frontMatter:()=>o,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"analytics/user-interface/spreadsheet-renderer","title":"Spreadsheet Renderer","description":"To render the query result as a spreadsheet, you can use the","source":"@site/docs/analytics/11-user-interface/03-spreadsheet-renderer.md","sourceDirName":"analytics/11-user-interface","slug":"/analytics/user-interface/spreadsheet-renderer","permalink":"/analytics/user-interface/spreadsheet-renderer","draft":false,"unlisted":false,"editUrl":"https://github.com/rekalogika/rekalogika-docs/edit/main/docs/analytics/11-user-interface/03-spreadsheet-renderer.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Spreadsheet Renderer"},"sidebar":"docs","previous":{"title":"Chart Generator","permalink":"/analytics/user-interface/chart-generator"},"next":{"title":"Pivot Table Panel","permalink":"/analytics/user-interface/pivot-table-panel"}}');var s=r(4848),a=r(8453);const o={title:"Spreadsheet Renderer"},i=void 0,c={},d=[];function p(e){const n={code:"code",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["To render the query result as a spreadsheet, you can use the\n",(0,s.jsx)(n.code,{children:"SpreadsheetRenderer::render()"})," method. It returns an instance of ",(0,s.jsx)(n.code,{children:"Spreadsheet"}),"\nfrom the ",(0,s.jsx)(n.code,{children:"phpoffice/phpspreadsheet"})," package."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"use Rekalogika\\Analytics\\Contracts\\SummaryManager;\nuse Rekalogika\\Analytics\\Frontend\\Spreadsheet\\SpreadsheetRenderer;\n\n/** @var SummaryManager $summaryManager */\n/** @var SpreadsheetRenderer $spreadsheetRenderer */\n\n$table = $summaryManager\n    ->createQuery()\n    // ...\n    ->getResult()\n    ->getTable();\n\n$spreadsheet = $spreadsheetRenderer->render(\n    table: $table\n    measures: ['price', 'count'],\n);\n"})}),"\n",(0,s.jsx)(n.p,{children:"Then, you can save the spreadsheet to a file or output it to the browser:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"use PhpOffice\\PhpSpreadsheet\\Writer\\Xlsx;\nuse Symfony\\Component\\HttpFoundation\\StreamedResponse;\n\n$writer = new Xlsx($spreadsheet);\n\n// Save to a file\n$writer->save('path/to/file.xlsx');\n\n// Or output to the browser\n$response = new StreamedResponse(\n    function () use ($writer) {\n        $writer->save('php://output');\n    },\n    200,\n    [\n        'Content-Type' => 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n        'Content-Disposition' => 'attachment; filename=\"report.xlsx\"',\n    ]\n);\n"})})]})}function l(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>i});var t=r(6540);const s={},a=t.createContext(s);function o(e){const n=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);