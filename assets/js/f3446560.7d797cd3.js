"use strict";(self.webpackChunkrekalogika_docs=self.webpackChunkrekalogika_docs||[]).push([[555],{5393:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>h,frontMatter:()=>l,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"file-bundle/lazy-loading","title":"Lazy-Loading Files","description":"This chapter describes how to implement the lazy-loading of files in your","source":"@site/docs/file-bundle/11-lazy-loading.md","sourceDirName":"file-bundle","slug":"/file-bundle/lazy-loading","permalink":"/file-bundle/lazy-loading","draft":false,"unlisted":false,"editUrl":"https://github.com/rekalogika/rekalogika-docs/edit/main/docs/file-bundle/11-lazy-loading.md","tags":[],"version":"current","sidebarPosition":11,"frontMatter":{"title":"Lazy-Loading Files"},"sidebar":"docs","previous":{"title":"Mandatory File","permalink":"/file-bundle/mandatory-file"},"next":{"title":"Replicating Metadata in Entities","permalink":"/file-bundle/replicating-metadata-in-entities"}}');var a=i(4848),o=i(8453);const l={title:"Lazy-Loading Files"},r=void 0,s={},d=[{value:"Property Set-Up",id:"property-set-up",level:2},{value:"Getter Set-Up",id:"getter-set-up",level:2},{value:"Lazy-Loading Proxy and Mandatory Files",id:"lazy-loading-proxy-and-mandatory-files",level:2}];function c(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.p,{children:"This chapter describes how to implement the lazy-loading of files in your\nentities."}),"\n",(0,a.jsx)(t.h2,{id:"property-set-up",children:"Property Set-Up"}),"\n",(0,a.jsxs)(t.p,{children:["To lazy-load files in your entities, simply add the parameter ",(0,a.jsx)(t.code,{children:"fetch: FetchMode::Lazy"})," to\nthe ",(0,a.jsx)(t.code,{children:"AsFileAssociation"})," attribute:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-php",children:"use Rekalogika\\Contracts\\File\\FileInterface;\nuse Rekalogika\\File\\Association\\Attribute\\AsFileAssociation;\nuse Rekalogika\\File\\Association\\Model\\FetchMode;\n\nclass Product\n{\n    // highlight-next-line\n    #[AsFileAssociation(fetch: FetchMode::Lazy)]\n    private FileInterface $image;\n}\n"})}),"\n",(0,a.jsx)(t.h2,{id:"getter-set-up",children:"Getter Set-Up"}),"\n",(0,a.jsx)(t.p,{children:"To preserve the normal behavior of your entity when using a lazy-loading proxy,\nyou should also modify the getter of the property like this:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-php",children:"use Rekalogika\\Contracts\\File\\FileInterface;\n// highlight-next-line\nuse Rekalogika\\Contracts\\File\\FileProxy;\nuse Rekalogika\\File\\Association\\Attribute\\AsFileAssociation;\n\nclass Product\n{\n    #[AsFileAssociation(fetch: FetchMode::Lazy)]\n    private FileInterface $image;\n\n    public function getImage(): ?FileInterface\n    {\n        // highlight-next-line\n        return FileProxy::getFile($this->image);\n    }\n}\n"})}),"\n",(0,a.jsx)(t.admonition,{title:"Protip",type:"tip",children:(0,a.jsx)(t.p,{children:"You might want to make sure other methods in the entity don't use the property\ndirectly but use the getter instead."})}),"\n",(0,a.jsx)(t.admonition,{type:"info",children:(0,a.jsxs)(t.p,{children:["The class ",(0,a.jsx)(t.code,{children:"FileDecorator"})," used in ",(0,a.jsx)(t.a,{href:"replicating-metadata-in-entities",children:"metadata\nreplication"})," and ",(0,a.jsx)(t.a,{href:"collection",children:"file collection"}),"\nis aware of lazy-loading proxies, so you don't need to modify the getter as\nexplained here if you are using ",(0,a.jsx)(t.code,{children:"FileDecorator"}),"."]})}),"\n",(0,a.jsx)(t.h2,{id:"lazy-loading-proxy-and-mandatory-files",children:"Lazy-Loading Proxy and Mandatory Files"}),"\n",(0,a.jsxs)(t.p,{children:["If you want both lazy-loading and mandatory files, please read the chapter\n",(0,a.jsx)(t.a,{href:"mandatory-file",children:"Mandatory File"}),"."]})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,t,i)=>{i.d(t,{R:()=>l,x:()=>r});var n=i(6540);const a={},o=n.createContext(a);function l(e){const t=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),n.createElement(o.Provider,{value:t},e.children)}}}]);