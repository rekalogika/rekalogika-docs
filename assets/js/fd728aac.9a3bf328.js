"use strict";(self.webpackChunkrekalogika_docs=self.webpackChunkrekalogika_docs||[]).push([[3083],{1328:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>l,default:()=>p,frontMatter:()=>a,metadata:()=>s,toc:()=>c});var i=n(4848),r=n(8453);const a={title:"Creating Filters"},l=void 0,s={id:"file-bundle/advanced/creating-filters",title:"Creating Filters",description:"This chapter explains how to create your own file filters using",source:"@site/docs/file-bundle/advanced/22-creating-filters.md",sourceDirName:"file-bundle/advanced",slug:"/file-bundle/advanced/creating-filters",permalink:"/file-bundle/advanced/creating-filters",draft:!1,unlisted:!1,editUrl:"https://github.com/rekalogika/rekalogika-docs/edit/main/docs/file-bundle/advanced/22-creating-filters.md",tags:[],version:"current",sidebarPosition:22,frontMatter:{title:"Creating Filters"},sidebar:"docs",previous:{title:"File Association Internal Details",permalink:"/file-bundle/advanced/entity-association-internal"},next:{title:"Object ID Resolver",permalink:"/file-bundle/advanced/object-id-resolver"}},o={},c=[];function d(e){const t={admonition:"admonition",code:"code",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(t.p,{children:["This chapter explains how to create your own file filters using\n",(0,i.jsx)(t.code,{children:"AbstractFileFilter"}),"."]}),"\n",(0,i.jsxs)(t.admonition,{title:"Preparation",type:"info",children:[(0,i.jsxs)(t.p,{children:["You need to install the package ",(0,i.jsx)(t.code,{children:"rekalogika/file-derivation"})," to use this\nfeature:"]}),(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"composer require rekalogika/file-derivation\n"})})]}),"\n",(0,i.jsxs)(t.p,{children:["To create a filter class, you can extend ",(0,i.jsx)(t.code,{children:"AbstractFileFilter"}),", create a method\n(or more) for the callers to specify the filtering parameters, and implement all\nthe abstract methods."]}),"\n",(0,i.jsx)(t.p,{children:"The following is an example filter class that creates a derived file by (rather\nuselessly) appending a text to the original content:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-php",children:"use Rekalogika\\Contracts\\File\\FileInterface;\nuse Rekalogika\\File\\Derivation\\Filter\\AbstractFileFilter;\nuse Rekalogika\\File\\TemporaryFile;\n\nclass TextAppender extends AbstractFileFilter\n{\n    private string $text;\n\n    /**\n     * Your custom method that lets the caller specify the filtering parameters.\n     */\n    public function appendText(string $text): self\n    {\n        assert(ctype_alpha($text)); // ensure alpha characters only\n        $this->text = $text;\n\n        return $this;\n    }\n\n    /**\n     * This method return the derivation ID from the filtering parameters the\n     * caller provided.\n     */\n    #[\\Override]\n    protected function getDerivationId(): string\n    {\n        return 'append_' . $this->text;\n    }\n\n    #[\\Override]\n    protected function process(): FileInterface\n    {\n        $originalContent = $this->getSourceFile()->getContent();\n\n        return new TemporaryFile::createFromString($originalContent . $this->text);\n    }\n}\n"})}),"\n",(0,i.jsxs)(t.p,{children:["If you are using autoconfiguration, then you are all set. Otherwise, you need\nto tag your class with ",(0,i.jsx)(t.code,{children:"rekalogika.file.derivation.filter"}),":"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-yaml",metastring:'title="config/services.yaml"',children:"services:\n    App\\TextAppender:\n        tags:\n            - { name: 'rekalogika.file.derivation.filter' }\n"})}),"\n",(0,i.jsx)(t.p,{children:"A caller will be able to use the above filter like the following:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-php",children:"use Rekalogika\\Contracts\\File\\FileInterface;\n\n/** @var TextAppender $textAppender */\n/** @var FileInterface $file */\n\n$derivedFile = $textAppender\n    ->take($file)\n    ->appendText('foo')\n    ->getResult();\n"})})]})}function p(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>l,x:()=>s});var i=n(6540);const r={},a=i.createContext(r);function l(e){const t=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(a.Provider,{value:t},e.children)}}}]);