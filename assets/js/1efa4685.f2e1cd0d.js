"use strict";(self.webpackChunkrekalogika_docs=self.webpackChunkrekalogika_docs||[]).push([[9057],{5397:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>a,toc:()=>s});const a=JSON.parse('{"id":"rekapager/adapters/doctrine-collection-selectable","title":"Doctrine Collections Selectable","description":"Takes a Doctrine Selectable instance, including Doctrine repository and","source":"@site/docs/rekapager/02-adapters/03-doctrine-collection-selectable.md","sourceDirName":"rekapager/02-adapters","slug":"/rekapager/adapters/doctrine-collection-selectable","permalink":"/rekapager/adapters/doctrine-collection-selectable","draft":false,"unlisted":false,"editUrl":"https://github.com/rekalogika/rekalogika-docs/edit/main/docs/rekapager/02-adapters/03-doctrine-collection-selectable.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Doctrine Collections Selectable"},"sidebar":"docs","previous":{"title":"Doctrine ORM NativeQuery","permalink":"/rekapager/adapters/doctrine-orm-nativequery"},"next":{"title":"Doctrine Collections Collection","permalink":"/rekapager/adapters/doctrine-collections-collection"}}');var r=n(4848),i=n(8453);const o={title:"Doctrine Collections Selectable"},l=void 0,c={},s=[{value:"Installation",id:"installation",level:2},{value:"Usage",id:"usage",level:2},{value:"<code>indexBy</code> Parameter",id:"indexby-parameter",level:3}];function d(e){const t={code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(t.p,{children:["Takes a Doctrine ",(0,r.jsx)(t.code,{children:"Selectable"})," instance, including Doctrine repository and\npractically all implementations of Doctrine collections. The adapter supports\nboth keyset and offset pagination."]}),"\n",(0,r.jsxs)(t.p,{children:["The class needs to work with a ",(0,r.jsx)(t.code,{children:"Criteria"})," object, but if the caller omits it,\nthe adapter will create an empty ",(0,r.jsx)(t.code,{children:"Criteria"})," object. If the ",(0,r.jsx)(t.code,{children:"Criteria"})," does not\nhave a sort order, the adapter will sort the collection using the field ",(0,r.jsx)(t.code,{children:"id"}),". If\nthe object does not have an ",(0,r.jsx)(t.code,{children:"id"})," field, Doctrine will throw an exception."]}),"\n",(0,r.jsx)(t.h2,{id:"installation",children:"Installation"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"composer require rekalogika/rekapager-doctrine-collections-adapter\n"})}),"\n",(0,r.jsx)(t.h2,{id:"usage",children:"Usage"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",children:"use Doctrine\\Common\\Collections\\Criteria;\nuse Doctrine\\ORM\\EntityRepository;\nuse Rekalogika\\Rekapager\\Doctrine\\Collections\\SelectableAdapter;\nuse Rekalogika\\Rekapager\\Keyset\\KeysetPageable;\nuse Rekalogika\\Rekapager\\Offset\\OffsetPageable;\n\n/** @var EntityRepository $postRepository */\n\n$selectable = $postRepository; // a Doctrine repository is also a Selectable\n// or\n$selectable = $user->getComments(); // a Doctrine Collection in an entity\n\n$criteria = Criteria::create()\n    ->where(Criteria::expr()->eq('group', $group))\n    ->orderBy([\n        'date' => Order::Descending,\n        'title' => Order::Ascending,\n        'id' => Order::Ascending\n    ]);\n\n// highlight-start\n$adapter = new SelectableAdapter(\n    collection: $selectable,\n    criteria: $criteria,\n    indexBy: 'id' // optional\n);\n// highlight-end\n\n$pageable = new KeysetPageable($adapter);\n// or\n$pageable = new OffsetPageable($adapter);\n"})}),"\n",(0,r.jsxs)(t.h3,{id:"indexby-parameter",children:[(0,r.jsx)(t.code,{children:"indexBy"})," Parameter"]}),"\n",(0,r.jsxs)(t.p,{children:["There is a Doctrine bug that may prevents a ",(0,r.jsx)(t.code,{children:"matching()"})," call from preserving\nthe keys of the collection. To workaround this issue, add the ",(0,r.jsx)(t.code,{children:"indexBy"}),"\nparameter to the adapter like the example above."]})]})}function p(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>l});var a=n(6540);const r={},i=a.createContext(r);function o(e){const t=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),a.createElement(i.Provider,{value:t},e.children)}}}]);