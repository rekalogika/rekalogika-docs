"use strict";(self.webpackChunkrekalogika_docs=self.webpackChunkrekalogika_docs||[]).push([[6348],{4203:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>c,default:()=>p,frontMatter:()=>l,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"reconstitutor/intro","title":"Introduction & Installation","description":"This library provides a thin layer that sits above Doctrine events to help you","source":"@site/docs/reconstitutor/01-intro.md","sourceDirName":"reconstitutor","slug":"/reconstitutor/intro","permalink":"/reconstitutor/intro","draft":false,"unlisted":false,"editUrl":"https://github.com/rekalogika/rekalogika-docs/edit/main/docs/reconstitutor/01-intro.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"title":"Introduction & Installation"},"sidebar":"docs","previous":{"title":"rekalogika/reconstitutor","permalink":"/reconstitutor/"},"next":{"title":"Usage","permalink":"/reconstitutor/usage"}}');var s=n(4848),o=n(8453),a=n(5537),i=n(9329);const l={title:"Introduction & Installation"},c=void 0,u={},d=[{value:"Features",id:"features",level:2},{value:"Installation",id:"installation",level:2},{value:"License",id:"license",level:2},{value:"Contributing",id:"contributing",level:2}];function h(e){const t={a:"a",code:"code",em:"em",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.p,{children:"This library provides a thin layer that sits above Doctrine events to help you\nreconstitute/hydrate your entities. It lets you augment Doctrine's hydration\nwith your logic in a concise and expressive class."}),"\n",(0,s.jsx)(t.p,{children:"After Doctrine hydrates an object from the database, this framework gives you\nthe control to hydrate additional properties not handled by Doctrine, without\nhaving to deal with the peculiarities of Doctrine events and Unit of Work.\nSimilar things also happen when the object is persisted to the database, or\nremoved."}),"\n",(0,s.jsx)(t.p,{children:"The most common case of this type of task is for handling file uploads, of\nwhich many specialized libraries have already been written. But plenty of other\ncases exist:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"A lazy-loading proxy that fetches the real resource using an API call."}),"\n",(0,s.jsx)(t.li,{children:"Linking objects that are managed by different object managers, or non-Doctrine\nentities."}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["These days, we usually call the process ",(0,s.jsx)(t.em,{children:"hydration"}),". ",(0,s.jsx)(t.em,{children:"Reconstitution"})," is the\nterm used by Eric Evans in the Blue Book: ",(0,s.jsx)(t.em,{children:'"Domain-Driven Design: Tackling\nComplexity in the Heart of Software"'}),"."]}),"\n",(0,s.jsx)(t.h2,{id:"features",children:"Features"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Streamlines a very specific, yet very common use case of Doctrine events."}),"\n",(0,s.jsx)(t.li,{children:"Simple declaration in a class. You can create a reconstitutor class to handle\nthe reconstitution of a specific entity class, entities that implement a\nspecific interface, entities in a class hierarchy, or those with a specific\nPHP attribute."}),"\n",(0,s.jsxs)(t.li,{children:["Our abstract classes provide ",(0,s.jsx)(t.code,{children:"get()"})," and ",(0,s.jsx)(t.code,{children:"set()"})," methods as a convenience.\nThey let you work with the properties directly, bypassing getters and setters.\nIt is the best practice in reconstitutions as it frees you to have business\nlogic in the getters and setters."]}),"\n",(0,s.jsxs)(t.li,{children:["The ",(0,s.jsx)(t.code,{children:"get()"})," and ",(0,s.jsx)(t.code,{children:"set()"})," methods are forwarders to a custom implementation of\nSymfony's ",(0,s.jsx)(t.code,{children:"PropertyAccessorInterface"}),". Therefore, you can use the same\nexceptions defined in ",(0,s.jsx)(t.code,{children:"PropertyAccessorInterface"}),"."]}),"\n",(0,s.jsx)(t.li,{children:"Abstracts all the peculiarities of Doctrine events, unit of work, and proxy,\nso you don't have to find out and deal with them yourself."}),"\n",(0,s.jsxs)(t.li,{children:["It has what we consider the correct behavior. It asks your reconstitutor to\nsave only after Doctrine has successfully saved the object. It doesn't rely on\nDoctrine seeing the object being dirty before ",(0,s.jsx)(t.code,{children:"flush()"}),"-ing. i.e. your\nentities don't have to modify a Doctrine-managed property \u2014like\n",(0,s.jsx)(t.code,{children:"$lastUpdated"}),"\u2014 just to make sure the correct Doctrine event will be fired."]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"installation",children:"Installation"}),"\n",(0,s.jsxs)(t.p,{children:["Make sure Composer is installed globally, as explained in the\n",(0,s.jsx)(t.a,{href:"https://getcomposer.org/doc/00-intro.md",children:"installation chapter"}),"\nof the Composer documentation."]}),"\n",(0,s.jsxs)(a.A,{children:[(0,s.jsxs)(i.A,{value:"flex",label:"With Symfony Flex",children:[(0,s.jsx)(t.p,{children:"Open a command console, enter your project directory, and execute:"}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"composer require rekalogika/reconstitutor\n"})})]}),(0,s.jsxs)(i.A,{value:"noflex",label:"Without Symfony Flex",children:[(0,s.jsx)(t.p,{children:"Step 1: Download the Bundle"}),(0,s.jsx)(t.p,{children:"Open a command console, enter your project directory, and execute the\nfollowing command to download the latest stable version of this bundle:"}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"composer require rekalogika/reconstitutor\n"})}),(0,s.jsx)(t.p,{children:"Step 2: Enable the Bundle"}),(0,s.jsxs)(t.p,{children:["Then, enable the bundle by adding it to the list of registered bundles\nin the ",(0,s.jsx)(t.code,{children:"config/bundles.php"})," file of your project:"]}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-php",metastring:'title="config/bundles.php"',children:"return [\n    // ...\n    Rekalogika\\Reconstitutor\\RekalogikaReconstitutorBundle::class => ['all' => true],\n];\n"})})]})]}),"\n",(0,s.jsx)(t.h2,{id:"license",children:"License"}),"\n",(0,s.jsx)(t.p,{children:"MIT"}),"\n",(0,s.jsx)(t.h2,{id:"contributing",children:"Contributing"}),"\n",(0,s.jsxs)(t.p,{children:["Issues and pull requests should be filed in the GitHub repository\n",(0,s.jsx)(t.a,{href:"https://github.com/rekalogika/reconstitutor",children:"rekalogika/reconstitutor"}),"."]})]})}function p(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},5537:(e,t,n)=>{n.d(t,{A:()=>k});var r=n(6540),s=n(4164),o=n(5627),a=n(6347),i=n(372),l=n(604),c=n(1861),u=n(8749);function d(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=t??function(e){return d(e).map((e=>{let{props:{value:t,label:n,attributes:r,default:s}}=e;return{value:t,label:n,attributes:r,default:s}}))}(n);return function(e){const t=(0,c.XI)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function p(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function f(e){let{queryString:t=!1,groupId:n}=e;const s=(0,a.W6)(),o=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,l.aZ)(o),(0,r.useCallback)((e=>{if(!o)return;const t=new URLSearchParams(s.location.search);t.set(o,e),s.replace({...s.location,search:t.toString()})}),[o,s])]}function m(e){const{defaultValue:t,queryString:n=!1,groupId:s}=e,o=h(e),[a,l]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!p({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const r=n.find((e=>e.default))??n[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:t,tabValues:o}))),[c,d]=f({queryString:n,groupId:s}),[m,b]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[s,o]=(0,u.Dv)(n);return[s,(0,r.useCallback)((e=>{n&&o.set(e)}),[n,o])]}({groupId:s}),y=(()=>{const e=c??m;return p({value:e,tabValues:o})?e:null})();(0,i.A)((()=>{y&&l(y)}),[y]);return{selectedValue:a,selectValue:(0,r.useCallback)((e=>{if(!p({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);l(e),d(e),b(e)}),[d,b,o]),tabValues:o}}var b=n(9136);const y={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var g=n(4848);function v(e){let{className:t,block:n,selectedValue:r,selectValue:a,tabValues:i}=e;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,o.a_)(),u=e=>{const t=e.currentTarget,n=l.indexOf(t),s=i[n].value;s!==r&&(c(t),a(s))},d=e=>{let t=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const n=l.indexOf(e.currentTarget)+1;t=l[n]??l[0];break}case"ArrowLeft":{const n=l.indexOf(e.currentTarget)-1;t=l[n]??l[l.length-1];break}}t?.focus()};return(0,g.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":n},t),children:i.map((e=>{let{value:t,label:n,attributes:o}=e;return(0,g.jsx)("li",{role:"tab",tabIndex:r===t?0:-1,"aria-selected":r===t,ref:e=>{l.push(e)},onKeyDown:d,onClick:u,...o,className:(0,s.A)("tabs__item",y.tabItem,o?.className,{"tabs__item--active":r===t}),children:n??t},t)}))})}function x(e){let{lazy:t,children:n,selectedValue:o}=e;const a=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=a.find((e=>e.props.value===o));return e?(0,r.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,g.jsx)("div",{className:"margin-top--md",children:a.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==o})))})}function j(e){const t=m(e);return(0,g.jsxs)("div",{className:(0,s.A)("tabs-container",y.tabList),children:[(0,g.jsx)(v,{...t,...e}),(0,g.jsx)(x,{...t,...e})]})}function k(e){const t=(0,b.A)();return(0,g.jsx)(j,{...e,children:d(e.children)},String(t))}},8453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>i});var r=n(6540);const s={},o=r.createContext(s);function a(e){const t=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(o.Provider,{value:t},e.children)}},9329:(e,t,n)=>{n.d(t,{A:()=>a});n(6540);var r=n(4164);const s={tabItem:"tabItem_Ymn6"};var o=n(4848);function a(e){let{children:t,hidden:n,className:a}=e;return(0,o.jsx)("div",{role:"tabpanel",className:(0,r.A)(s.tabItem,a),hidden:n,children:t})}}}]);