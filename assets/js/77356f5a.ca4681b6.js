"use strict";(self.webpackChunkrekalogika_docs=self.webpackChunkrekalogika_docs||[]).push([[5881],{1768:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>o,default:()=>m,frontMatter:()=>s,metadata:()=>r,toc:()=>c});var i=n(5893),a=n(1151);const s={title:"Immediate Dispatcher Handling & Troubleshooting"},o=void 0,r={id:"domain-event/immediate-dispatcher",title:"Immediate Dispatcher Handling & Troubleshooting",description:"Immediate Dispatcher in Unit Tests",source:"@site/docs/domain-event/03-immediate-dispatcher.md",sourceDirName:"domain-event",slug:"/domain-event/immediate-dispatcher",permalink:"/domain-event/immediate-dispatcher",draft:!1,unlisted:!1,editUrl:"https://github.com/rekalogika/rekalogika-docs/edit/main/docs/domain-event/03-immediate-dispatcher.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{title:"Immediate Dispatcher Handling & Troubleshooting"},sidebar:"docs",previous:{title:"Manual Control",permalink:"/domain-event/manual-control"},next:{title:"Tips and Caveats",permalink:"/domain-event/tips"}},d={},c=[{value:"Immediate Dispatcher in Unit Tests",id:"immediate-dispatcher-in-unit-tests",level:3}];function l(e){const t={admonition:"admonition",code:"code",h3:"h3",p:"p",pre:"pre",...(0,a.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h3,{id:"immediate-dispatcher-in-unit-tests",children:"Immediate Dispatcher in Unit Tests"}),"\n",(0,i.jsx)(t.p,{children:"Immediate event dispatcher works by installing the event dispatcher to a static\nvariable. This installation happens during the kernel boot."}),"\n",(0,i.jsx)(t.p,{children:"If the kernel is not booted, there is no opportunity to install the event\ndispatcher. This usually happens only in isolated unit tests. To address the\nproblem, you can install a stub event dispatcher manually like this."}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-php",children:"use PHPUnit\\Framework\\TestCase;\nuse Rekalogika\\DomainEvent\\ImmediateDomainEventDispatcherInstaller;\nuse Symfony\\Component\\EventDispatcher\\EventDispatcher;\n\nclass SomeTest extends TestCase\n{\n    public function setUp(): void\n    {\n        $installer = new ImmediateDomainEventDispatcherInstaller(new EventDispatcher);\n        $installer->install();\n    }\n\n    // ...\n}\n"})}),"\n",(0,i.jsx)(t.admonition,{type:"note",children:(0,i.jsx)(t.p,{children:"The stub dispatcher doesn't do anything. If you want to test the dispatching,\nyou need to get the real dispatcher from the container."})})]})}function m(e={}){const{wrapper:t}={...(0,a.a)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},1151:(e,t,n)=>{n.d(t,{Z:()=>r,a:()=>o});var i=n(7294);const a={},s=i.createContext(a);function o(e){const t=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),i.createElement(s.Provider,{value:t},e.children)}}}]);